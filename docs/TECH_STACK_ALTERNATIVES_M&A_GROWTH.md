# 事業売却前提・直近1年コスト最小のテックスタック選択肢

**前提**: 事業売却（M&A）を想定し、直近1年はランニングコストを抑えつつグロースさせる。**記事は500記事以上を追加予定**とする。

**記事作成フロー**: 記事は **Cursor 上では作らない**。Gemini でディープリサーチ→骨子→記事作成を行い、その内容を **CMS に追加していく** 形を想定する。Cursor は Next.js アプリ（表示・API 連携・ツール等）の開発のみに使う。

**契約ツール（正式前提）**: 以下の 4 ツールで運用する（「Gemini→CMS 前提での契約ツール（再まとめ）」PDF に準拠）。**Vercel Pro**（ホスティング）・**microCMS または Sanity**（CMS・常に必須）・**Supabase Free**（DB・リード）・**Resend Free**（メール・PDF）。年間コストは Vercel Pro のみ約36,000円。この前提に基づく具体的な改善提案は **`docs/GEMINI_CMS_STACK_IMPROVEMENTS.md`** を参照。

---

## 0. 重要な前提：商用利用とホスティング

- **Vercel 無料（Hobby）は商用利用不可**。広告・アフィリエイト・有料機能など利益が出る場合は **Pro（月$20〜）必須**。
- 直近1年で「ほぼ無料」を狙うなら、**Vercel Pro のみ有料**とし、他は無料枠で揃えるのが現実的。

---

## 1. レイヤー別の選択肢

### CMS（記事管理）

**※記事は Gemini で作成し CMS に追加する前提のため、Cursor/リポジトリ内で編集する「JSON」「Tina/Decap（Gitベース）」は向かない。CMS は管理画面 or API で追加できる **microCMS または Sanity が必須**。**

| 選択肢 | 直近1年コスト | 無料枠の目安 | M&A・譲渡 | グロース向き | 備考 |
|--------|----------------|--------------|-----------|--------------|------|
| **microCMS** | **0円**（Hobby） | API 5個、転送20GB/月、無制限呼び出し | ◎ アカウント譲渡で完結 | ◎ 国産・管理画面が使いやすい | **管理画面に貼り付け or API で投入**。Gemini の出力をそのまま追加可能。 |
| **Sanity** | **0円**（Free） | 10k doc、5M CDN req、100GB帯域/アセット | ◎ プロジェクト譲渡で完結 | ◎ 海外標準・ドキュメント豊富 | **管理画面 or API で投入**。Gemini の出力をそのまま追加可能。無料枠が広い。 |
| **現状のJSON（content/articles）** | **0円** | 制限なし（リポジトリ内） | △ 資産性は弱い | △ 編集は開発者・Cursor 前提 | **Gemini→CMS 運用には不向き**。追加のたびに Cursor でファイル編集が必要。 |
| **Tina CMS / Decap CMS** | **0円** | Gitベース、ホスト不要 | ○ リポジトリ譲渡で完結 | △ 編集は GitHub 等前提 | **Gemini→CMS 運用には不向き**。コンテンツ追加が Git 経由になる。 |

**推奨（Gemini で記事作成 → CMS に追加する前提）**

- **CMS は必須**。**microCMS** または **Sanity** のどちらかを採用する。
- **運用イメージ**: Gemini で記事作成 → 管理画面にコピペで登録、または **CMS の API で一括登録**（スクリプトで Gemini 出力を POST するなど。実行場所は Cursor でなくても可）。
- **Cursor でやること**: Next.js 側で **CMS API から記事を取得して表示する実装** のみ。記事本文の編集・追加は CMS 上で完結する。

**※500記事以上を想定する場合の注意** → 下記「500記事以上を想定する場合」を参照。

**ワークフロー整理（Gemini → CMS、Cursor では作らない場合）**

| 役割 | やること | 使う場所・ツール |
|------|----------|------------------|
| 記事の企画・執筆 | ディープリサーチ → 骨子 → 本文 | **Gemini** |
| 記事の保存・公開 | 作成した本文を登録・公開 | **CMS（microCMS / Sanity）** の管理画面に貼り付け or **API で一括投入** |
| サイト表示・API 連携 | 記事一覧・個別ページの表示、リード獲得、ツール | **Cursor で開発する Next.js アプリ**（CMS API から取得して表示） |

- Cursor では **記事の中身は書かない・編集しない**。CMS から取得するだけの実装と、ツール・リード・ガイドブック等の機能開発のみ。
- 一括投入したい場合は、Gemini の出力（JSON や CSV など）を **microCMS / Sanity の API** に流すスクリプトを別途用意する（Google Apps Script・ローカルスクリプト等、Cursor 外で実行可）。

---

### DB / Auth（顧客・リード管理）

| 選択肢 | 直近1年コスト | 無料枠の目安 | M&A・譲渡 | 備考 |
|--------|----------------|--------------|-----------|------|
| **Supabase** | **0円**（Free） | DB 500MB、Auth 5万MAU、ストレージ1GB、帯域2GB/月 | ◎ アカウント譲渡で完結。PostgreSQLで買い手に説明しやすい | **現状採用済み**。リード・イベント保存にそのまま利用可能 |
| **Firebase** | **0円**（Spark） | Firestore 1GB、読み5万/日・書込2万/日など | ◎ 譲渡容易。海外買い手に馴染みやすい | NoSQL。集計・レポートはSupabase（SQL）よりやや組み立てが必要 |
| **PlanetScale** | **0円**（Hobby） | 5GB、1B row read/月 | ◎ MySQL。譲渡＝アカウント移行 | Auth は別（NextAuth 等）が必要。DBだけ使うなら選択肢 |
| **Neon** | **0円**（Free） | 0.5GB、ブランチあり | ◎ Postgres。譲渡容易 | DB専用。Auth は NextAuth + DB など別構成 |

**推奨**

- **現状のまま Supabase を継続**が最もコスト・譲渡・実装の一貫性で有利。無料枠でリード＋イベントは1年十分賄える。

---

### Email / PDF（自動配信・ガイドブック送付など）

| 選択肢 | 直近1年コスト | 無料枠の目安 | M&A・譲渡 | 備考 |
|--------|----------------|--------------|-----------|------|
| **Resend** | **0円**（Free） | 月3,000通、1日100通 | ◎ APIベース。譲渡＝APIキー引き継ぎ | 開発者向け。Next.js と相性◎。PDF添付も容易（黄金スタック） |
| **Brevo（旧Sendinblue）** | **0円**（Free） | **1日300通**（月約9,000通） | ◎ 譲渡容易 | 無料枠が広い。マーケメール・自動化も可能。到達率は要検証 |
| **SendGrid** | **0円**（Free） | 1日100通（月約3,000通） | ◎ 定番。譲渡しやすい | 代理店経由で無料枠拡大の選択肢あり |
| **Amazon SES** | 従量（非常に安い） | 62,000通/月まで無料（EC2等から送る場合） | ○ AWSアカウント譲渡。設定はやや重い | 送信量が増えた後のコスト削減に強い。初期設定コストあり |

**推奨**

- **直近1年で送信数が月3,000通以内なら Resend 無料**で十分。ガイドブックPDF送付・リードへの自動返信を Resend に統一すると設計と実装が一致する。
- **メール送信を増やしてグロースさせたい**（ニュースレター・フォローアップ増）なら、**Brevo 無料（1日300通）** を検討。

---

### ホスティング

| 選択肢 | 直近1年コスト | 備考 |
|--------|----------------|------|
| **Vercel Pro** | **約$20/月（約3,000円/月）** | 商用利用可能。Next.js と最適化。譲渡＝プロジェクト移管。**事業利用ならほぼ必須** |
| **Netlify** | 無料〜有料 | 商用は有料プラン要。Vercel と同様の考え方 |
| **Cloudflare Pages** | 無料枠が広い | 商用利用条件要確認。Next.js は対応しているが Vercel ほど最適化されていない |

**推奨**

- 事業・アフィリエイト収益を前提にするなら **Vercel Pro（月$20）** を「直近1年の固定費」と見做すのが現実的。他を無料枠で揃えれば **年間約36,000円程度** に抑えられる。

---

## 1.5 500記事以上を想定する場合

記事数を **500記事以上** に増やす前提で、CMS・ホスティングの選び方と注意点をまとめる。

### CMS

| 選択肢 | 500記事での可否 | 注意点・推奨 |
|--------|-----------------|--------------|
| **microCMS Hobby** | 記事数は **OK**（最大10,000件まで）。API 5個で足りる。 | **データ転送量 20GB/月** がボトルネック。PVが増えると超過→API停止のリスクあり。対策: 一覧はページネーション・CDNキャッシュ・ISR でAPI呼び出しを抑える。トラフィックが伸びたら **Team（4,900円/月〜、超過分従量）** への移行を検討。 |
| **Sanity Free** | **◎ 余裕でOK**。ドキュメント上限 10,000 件。500記事＋カテゴリ・メディアでも十分。帯域 100GB/月。 | 500記事規模なら **無料のまま運用しやすい**。M&A 時もプロジェクト譲渡で完結。 |
| **現状のJSON（content/articles）** | 技術的には可能。 | 500本の JSON をリポジトリに置くと **ビルド時間が伸びる**（全記事 SSG で500ページ生成）。編集は開発者前提。非推奨。 |
| **Tina / Decap（Gitベース）** | 可能。 | 500ファイルの Git 管理・ビルド負荷は同様。非エンジニア編集は GitHub 連携が必要。 |

**500記事以上の場合の推奨**

- **無料で収めたい**: **Sanity Free** を採用。10k doc・100GB 帯域で 500記事＋成長余裕あり。
- **国産・管理画面を優先**: **microCMS** を採用し、まず **Hobby** で開始。転送量が心配になったら **Team** にアップグレード（月4,900円〜、超過分従量）。

### ホスティング・ビルド

- **Vercel Pro**: ビルド時間の枠は Pro で増える。500記事を全件 SSG すると 1 回のビルドで数分〜十数分かかる可能性あり。
- **推奨**: 記事一覧は **ページネーション or トップN件のみ SSG**、個別記事は **ISR（revalidate）** や **on-demand 再生成** を検討し、ビルド時間と初回表示のバランスを取る。CMS（microCMS / Sanity）なら API で取得するため、SSG しない構成にもしやすい。

---

## 2. 提案：2パターン

### パターンA：黄金スタック維持（推奨）

| レイヤー | 採用 | 直近1年コスト |
|----------|------|----------------|
| ホスティング | Vercel Pro | 約$20/月 |
| CMS | microCMS Hobby（または **Sanity Free**：500記事以上なら推奨） | 0円（転送量が心配なら microCMS Team で約4,900円/月〜） |
| DB / Auth | Supabase Free | 0円 |
| Email / PDF | Resend Free | 0円 |

- **年間目安**: 約 **36,000円**（Vercel Pro のみ）。500記事で転送量を気にする場合は microCMS Team で **年間＋約59,000円**、または **Sanity Free のまま 0円**。
- **メリット**: 買い手に「CMS・DB・メール」を一括で説明しやすい。**500記事以上なら Sanity Free を選ぶと無料枠で余裕**。microCMS のままなら必要時に Team へスライド。

---

### パターンB：CMS を無料枠で収める（Gemini→CMS 前提）

| レイヤー | 採用 | 直近1年コスト |
|----------|------|----------------|
| ホスティング | Vercel Pro | 約$20/月（商用のため省略不可） |
| CMS | **Sanity Free**（500記事以上でも無料枠で余裕） | 0円 |
| DB / Auth | Supabase Free | 0円 |
| Email / PDF | Resend または Brevo Free | 0円 |

- **年間目安**: 約 **36,000円**（Vercel Pro のみ）。A と同じ。
- **違い**: 記事は **Gemini で作成 → Sanity に追加**。Cursor では記事を書かず、CMS 管理画面 or API で投入。**JSON や Git ベースは「Cursor で作らない」前提に合わないため使わない**。

---

### パターンC：メール送信量を多めに見る（グロース重視）

- CMS・DB は A と同じ（microCMS + Supabase）。
- **Email**: **Brevo 無料**（1日300通）にして、リードフォロー・ニュースレターを増やしても無料枠内に収める。
- ホスティングは Vercel Pro のまま。年間コストは A と同程度。

---

## 3. まとめ

| 観点 | 推奨 |
|------|------|
| **事業売却を前提にした譲渡のしやすさ** | microCMS + Supabase + Resend（または Brevo）の組み合わせは、いずれも「アカウント・APIキー譲渡」で完結し、買い手が技術的に理解しやすい。 |
| **直近1年のランニングコスト** | **Vercel Pro のみ有料**とし、CMS・DB・メールは無料枠で揃えれば **年間約3.6万円程度** に抑えられる。 |
| **グロース** | 無料枠でリード獲得・メール送信・記事公開は十分可能。送信数が多い場合は Brevo 無料枠（1日300通）を検討。 |
| **記事を Cursor で作らない（Gemini→CMS）** | **CMS は必須**。JSON・Git ベースは不向き。**microCMS または Sanity** で管理画面 or API に Gemini の出力を追加。Cursor は「CMS から取得して表示する」実装のみ。 |
| **500記事以上を想定する場合** | **Sanity Free** を推奨（10k doc・100GB帯域で無料のまま余裕）。国産・管理画面を優先するなら microCMS Hobby で開始し、転送量20GB/月が心配になったら Team（4,900円/月〜）へ。ビルドは ISR・ページネーションで負荷を分散。 |

**結論**:  
**「Vercel Pro + CMS（microCMS Hobby または Sanity Free）+ Supabase Free + Resend Free」の黄金スタックを維持し、直近1年は Vercel 以外を無料で運用する（パターンA）** のが、事業売却前提・コスト最小・グロースのバランスが良い。**500記事以上なら Sanity Free を CMS に選ぶと無料枠で余裕**。メールを多く送るなら Brevo を検討（パターンC）。

---

## 別途新規で契約すべきツール一覧

事業として本番運用するにあたり、**新規に契約（または無料登録）が必要なツール**をまとめる。**記事は Gemini で作成し CMS に追加する前提のため、CMS（microCMS または Sanity）の契約・登録は必須**（JSON や Git ベースは Cursor 外で「どんどん追加」する運用に不向き）。

---

### Gemini→CMS 前提での契約ツール（再まとめ）

**契約するツールの「種類」は変わらない。変わるのは「CMS が必須になる」ことだけ。**

| # | ツール | 用途 | プラン | 目安コスト（年） | 備考 |
|---|--------|------|--------|------------------|------|
| 1 | **Vercel** | ホスティング・デプロイ | Pro | 約36,000円 | 商用利用のため必須。 |
| 2 | **microCMS** または **Sanity** | CMS（記事管理） | Hobby / Free | 0円（Sanity Free 推奨） | **Gemini→CMS のため必須**。管理画面 or API に Gemini の出力を追加。500記事以上なら Sanity Free 推奨。 |
| 3 | **Supabase** | DB・Auth（リード・イベント） | Free | 0円 | リード・イベント保存に必須。 |
| 4 | **Resend** | メール・PDF送付 | Free | 0円 | ガイドブック送付・リード返信。月3,000通まで無料。 |

**合計（年間）**: 約 **36,000円**（Vercel Pro のみ。他は無料枠）。  
**変更点**: 以前「CMS は記事を CMS 化する場合」だったが、**Gemini→CMS 前提では CMS は常に必須**。ツールの数・種類は同じ 4 つ（Vercel・CMS・Supabase・Resend）。

---

### 必須（商用利用のため必ず契約）

| ツール | 用途 | プラン | 目安コスト | 契約・登録 |
|--------|------|--------|------------|------------|
| **Vercel** | ホスティング・デプロイ（Next.js 本番公開） | **Pro** | 約$20/月（約3,000円/月） | [vercel.com](https://vercel.com) でアカウント作成 → Pro にアップグレード。商用利用のため Hobby（無料）は不可。 |

---

### 必須（Gemini→CMS 前提：記事を CMS に追加するため）

| ツール | 用途 | プラン | 目安コスト | 契約・登録 |
|--------|------|--------|------------|------------|
| **microCMS** または **Sanity** | CMS（記事管理・API） | **Hobby / Free**（500記事以上で転送量が心配なら microCMS **Team** 約4,900円/月〜） | 0円 or 約4,900円/月〜 | **Gemini→CMS のため必須**。[microcms.io](https://microcms.io) または [sanity.io](https://sanity.io) でアカウント作成。管理画面に貼り付け or API で一括投入。**500記事以上なら Sanity Free 推奨**。 |

---

### 必須（リード・メール運用のため）

| ツール | 用途 | プラン | 目安コスト | 契約・登録 |
|--------|------|--------|------------|------------|
| **Supabase** | DB・Auth（リード・イベント保存） | **Free** | 0円 | [supabase.com](https://supabase.com) でアカウント作成。`leads` / `lead_events` テーブルを SQL で作成。環境変数に URL と Service Role Key を設定。 |
| **Resend** | メール送信・PDF添付（ガイドブック送付・リード返信） | **Free** | 0円（月3,000通まで） | [resend.com](https://resend.com) でアカウント作成。API キーを取得し環境変数に設定。 |

---

### 代替で検討する場合（オプション）

| ツール | 用途 | いつ選ぶか | プラン・目安コスト |
|--------|------|------------|---------------------|
| **Brevo（旧Sendinblue）** | メール送信 | Resend の代わりに、送信量を多くしたい場合（1日300通＝月約9,000通まで無料） | Free / 0円 |
| **Sanity** | CMS | microCMS の代わりに、無料枠の広い海外CMSを使う場合 | Free / 0円 |
| **Tina CMS / Decap CMS** | CMS（Gitベース） | ホスト不要・完全無料で記事を Git 管理したい場合 | 無料（契約不要・OSS） |
| **SendGrid** | メール送信 | Resend / Brevo 以外の定番を使う場合 | Free（1日100通） |
| **Amazon SES** | メール送信 | 送信量が非常に多くなった後のコスト削減 | 従量・無料枠あり（AWS 設定必要） |
| **Firebase** | DB・Auth | Supabase の代わりに NoSQL で統一したい場合 | Spark（無料） |
| **PlanetScale / Neon** | DB | Supabase の代わりに DB のみ別サービスにしたい場合 | 各 Free / 0円 |

---

### 一覧サマリ（Gemini→CMS 前提・契約ツールまとめ）

| # | ツール | 契約 | コスト（直近1年） |
|---|--------|------|-------------------|
| 1 | **Vercel** | 新規登録 → Pro にアップグレード | 約36,000円/年 |
| 2 | **microCMS** または **Sanity** | 新規登録（Hobby / Free）※**必須** | 0円（500記事以上なら Sanity Free 推奨。microCMS Team なら約59,000円/年〜） |
| 3 | **Supabase** | 新規登録（Free） | 0円 |
| 4 | **Resend** | 新規登録（Free） | 0円 |

**合計（年間）**: 約 **36,000円**（Vercel Pro のみ。CMS・DB・メールは無料枠）。500記事で microCMS Team にした場合は **約95,000円/年** 程度。

---

## ガイドブック登録・PDF自動送付（メール格納先と自動送信）

### メールアドレスはどこに格納されますか？

- **格納先**: **Supabase の `leads` テーブル**です。
- **流れ**: ガイドブックページの「無料で受け取る」送信 → `POST /api/lead`（body: `email`, `source: "guidebook"` 等）→ 環境変数 `NEXT_PUBLIC_SUPABASE_URL` と `SUPABASE_SERVICE_ROLE_KEY` が設定されていれば、**Supabase の `leads` に保存**されます。
- **未設定時**: 上記環境変数が無い場合は DB には保存されず、コンソールログのみです。本番では Supabase の契約・テーブル作成・環境変数設定が必須です。

### 登録者に自動でPDFをお送りしたい場合

- **現状**: **自動送信は未実装**です。登録は Supabase に保存されるだけで、**メールやPDFは送っていません**。画面では「ガイドブックをメールでお送りしました」と表示していますが、実際の送信処理はありません。
- **このツール（契約スタック）で賄えるか**: **はい、賄えます。** 契約している **Resend** で「登録直後にメールでPDFを添付して送る」ことが可能です。
- **必要な実装**:
  1. **Resend** の契約・API キー取得（契約一覧のとおり）。
  2. **ガイドブックPDF** を配置する（例: `public/guidebook.pdf` やストレージのURL）。サーバーから読み込める場所に1つ用意する。
  3. **`POST /api/lead` の拡張**: Supabase への保存が成功したあと、`source === "guidebook"` のときだけ **Resend API を呼び、登録メールアドレス宛にPDF添付メールを送る**。
  4. 送信元メールアドレス・件名・本文は Resend の設定（ドメイン認証等）に合わせて実装する。

| 要件 | 担当 | 状態 |
|------|------|------|
| メールアドレスの格納 | Supabase `leads` | ✅ 実装済み（環境変数設定時） |
| 登録者へのPDF自動送信 | Resend（メール＋PDF添付） | ❌ 未実装（実装すれば賄える） |

**結論**: メールの格納は **Supabase で賄えている**。PDFの自動送付は **Resend で賄えるが、現状は未実装**。上記のとおり `/api/lead` に Resend 呼び出しとPDF添付を追加すれば、このツール（スタック）だけで実現できます。
